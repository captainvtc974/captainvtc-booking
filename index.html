<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Captain VTC - R√©servation</title>
    <!-- Tailwind CSS - Version optimis√©e production -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- Google Maps API - Chargement optimis√© -->
    <script>
        window.initMap = function() {
            console.log('‚úÖ Google Maps API charg√©e');
        };
    </script>
    <script 
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAnVqglyHZ04BSmBaPT2V1Jqm9aLMvcj3E&libraries=places&loading=async&callback=initMap"
        async defer
    ></script>
    <style>
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        /* Styles pour autocomplete personnalis√© */
        .autocomplete-list {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid #ddd;
            border-top: none;
            border-radius: 0 0 8px 8px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }
        .autocomplete-list.active {
            display: block;
        }
        .autocomplete-item {
            padding: 12px 16px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
            font-size: 14px;
            color: #333;
        }
        .autocomplete-item:hover {
            background-color: #f0f0f0;
        }
        .autocomplete-item.selected {
            background-color: #e3f2fd;
            color: #1976d2;
        }
        .autocomplete-wrapper {
            position: relative;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <header class="bg-gradient-to-r from-blue-600 to-indigo-700 text-white shadow-lg">
        <div class="container mx-auto px-4 py-6">
            <div class="flex flex-col md:flex-row items-center justify-between gap-4">
                <div>
                    <h1 class="text-3xl font-bold">Captain VTC</h1>
                    <p class="text-blue-100 text-sm">Votre chauffeur √† La R√©union</p>
                </div>
                <div class="flex flex-col md:flex-row items-center gap-4 text-sm">
                    <a href="tel:+262693479647" class="flex items-center space-x-2 hover:text-blue-200 transition">
                        <span>üìû</span>
                        <span>+262 06 93 47 96 47</span>
                    </a>
                    <a href="mailto:contact@captainvtc.com" class="flex items-center space-x-2 hover:text-blue-200 transition">
                        <span>‚úâÔ∏è</span>
                        <span class="hidden md:inline">contact@captainvtc.com</span>
                    </a>
                </div>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8">
        <div class="max-w-4xl mx-auto">
            <div id="successMessage" class="hidden bg-green-50 border-2 border-green-500 rounded-xl p-6 mb-6 animate-pulse">
                <div class="flex items-center space-x-3">
                    <span class="text-3xl">‚úÖ</span>
                    <div>
                        <h3 class="text-xl font-bold text-green-900">Demande envoy√©e avec succ√®s !</h3>
                        <p class="text-green-700">Nous vous contacterons rapidement pour confirmer votre r√©servation.</p>
                    </div>
                </div>
            </div>

            <div id="bookingForm" class="bg-white rounded-2xl shadow-xl p-6 md:p-8 mb-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">R√©server votre course</h2>
                
                <form id="mainForm" class="space-y-6">
                    <div>
                        <label class="flex items-center text-sm font-semibold text-gray-700 mb-2">
                            <span class="mr-2">üìç</span>
                            Lieu de d√©part
                        </label>
                        <select id="departure" required class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition">
                            <option value="">S√©lectionnez un lieu</option>
                        </select>
                    </div>

                    <div>
                        <label class="flex items-center text-sm font-semibold text-gray-700 mb-2">
                            <span class="mr-2">üéØ</span>
                            Destination
                        </label>
                        <select id="destination" required class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition">
                            <option value="">S√©lectionnez une destination</option>
                        </select>
                    </div>

                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="flex items-center text-sm font-semibold text-gray-700 mb-2">
                                <span class="mr-2">üìÖ</span>
                                Date de d√©part
                            </label>
                            <input type="date" id="date" required class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition">
                        </div>
                        <div>
                            <label class="flex items-center text-sm font-semibold text-gray-700 mb-2">
                                <span class="mr-2">‚è∞</span>
                                Heure de d√©part
                            </label>
                            <input type="time" id="time" required class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition">
                        </div>
                    </div>

                    <div>
                        <label class="flex items-center text-sm font-semibold text-gray-700 mb-2">
                            <span class="mr-2">üë•</span>
                            Nombre de passagers
                        </label>
                        <select id="passengers" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition">
                            <option value="1">1 passager</option>
                            <option value="2">2 passagers</option>
                            <option value="3">3 passagers</option>
                            <option value="4">4 passagers</option>
                            <option value="5">5 passagers</option>
                            <option value="6">6 passagers</option>
                            <option value="7">7 passagers</option>
                            <option value="8">8 passagers</option>
                        </select>
                    </div>

                    <div id="airportFields" class="hidden space-y-4 bg-blue-50 p-4 rounded-lg border-2 border-blue-300">
                        <p class="text-sm font-semibold text-blue-900 flex items-center">
                            <span class="mr-2">‚úàÔ∏è</span>
                            Informations de vol
                        </p>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <label class="flex items-center text-sm font-semibold text-gray-700 mb-2">
                                    <span class="mr-2">üõ´</span>
                                    Num√©ro de vol
                                </label>
                                <input type="text" id="flightNumber" placeholder="Ex: AF2345" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition">
                            </div>
                            <div>
                                <label class="flex items-center text-sm font-semibold text-gray-700 mb-2">
                                    <span class="mr-2">üß≥</span>
                                    Nombre de bagages
                                </label>
                                <select id="luggage" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition">
                                    <option value="0">Aucun bagage</option>
                                    <option value="1">1 bagage</option>
                                    <option value="2">2 bagages</option>
                                    <option value="3">3 bagages</option>
                                    <option value="4">4 bagages</option>
                                    <option value="5">5 bagages</option>
                                    <option value="6">6 bagages ou +</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <button type="button" onclick="calculatePrice()" class="w-full bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-4 rounded-lg font-semibold text-lg hover:from-blue-700 hover:to-indigo-700 transition shadow-lg">
                        Calculer le tarif
                    </button>

                    <div id="errorMessage" class="hidden bg-red-50 border-l-4 border-red-500 p-4 rounded flex items-start space-x-3">
                        <span>‚ö†Ô∏è</span>
                        <p id="errorText" class="text-red-700"></p>
                    </div>

                    <div class="bg-yellow-50 border-2 border-yellow-300 rounded-lg p-4">
                        <button type="button" onclick="toggleInfo()" class="w-full flex items-center justify-between text-left font-semibold text-yellow-800">
                            <span>‚ÑπÔ∏è Informations importantes</span>
                            <span id="infoArrow">‚ñº</span>
                        </button>
                        <div id="infoContent" class="hidden mt-4 space-y-3 text-sm text-gray-700">
                            <div class="bg-white p-3 rounded border-l-4 border-yellow-500">
                                <p class="font-semibold text-yellow-800 mb-1">üí∞ Tarifs</p>
                                <p>Les tarifs sont fixes selon notre grille. Les suppl√©ments sont calcul√©s automatiquement.</p>
                            </div>
                            <div class="bg-white p-3 rounded border-l-4 border-orange-500">
                                <p class="font-semibold text-orange-800 mb-1">‚è∞ Retards et attente</p>
                                <p>Des frais suppl√©mentaires peuvent s'appliquer en cas de retard ou temps d'attente prolong√©.</p>
                            </div>
                            <div class="bg-white p-3 rounded border-l-4 border-blue-500">
                                <p class="font-semibold text-blue-800 mb-1">‚úÖ Validation</p>
                                <p>La r√©servation sera confirm√©e apr√®s contact t√©l√©phonique selon nos disponibilit√©s.</p>
                            </div>
                        </div>
                    </div>
                </form>
            </div>

            <div id="resultSection" class="hidden bg-white rounded-2xl shadow-xl p-6 md:p-8 mb-6">
                <h3 class="text-2xl font-bold text-gray-800 mb-6">D√©tails de votre course</h3>
                
                <div class="bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-xl mb-6">
                    <span class="text-4xl">üí∞</span>
                    <p id="totalPrice" class="text-4xl font-bold text-purple-900 mt-2">0 ‚Ç¨</p>
                    <p class="text-sm text-purple-700">Tarif total estim√©</p>
                    <p id="priceDetail" class="text-xs text-purple-600 mt-1"></p>
                </div>

                <div class="space-y-4 mb-6">
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <p class="text-sm text-gray-600 mb-1">Itin√©raire</p>
                        <p id="routeDisplay" class="text-lg font-semibold text-gray-800"></p>
                    </div>

                    <div class="grid md:grid-cols-2 gap-4">
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <p class="text-sm text-blue-600 mb-1">Date et heure</p>
                            <p id="dateTimeDisplay" class="font-semibold text-gray-800"></p>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-lg">
                            <p class="text-sm text-purple-600 mb-1">Passagers</p>
                            <p id="passengersDisplay" class="font-semibold text-gray-800"></p>
                        </div>
                    </div>

                    <div id="airportBadge" class="hidden bg-blue-50 border-l-4 border-blue-400 p-4 rounded">
                        <p class="text-sm text-blue-800 font-semibold">‚úàÔ∏è Transfert a√©roport</p>
                        <p class="text-xs text-blue-700 mt-1">Service avec suivi de vol inclus</p>
                    </div>
                </div>

                <div id="supplementsSection" class="hidden bg-amber-50 border-l-4 border-amber-400 p-4 rounded mb-6">
                    <p class="text-sm font-semibold text-amber-800 mb-3">D√©tail des suppl√©ments :</p>
                    <div id="supplementsList" class="space-y-2"></div>
                </div>

                <button onclick="showContactForm()" class="w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white py-4 rounded-lg font-semibold text-lg hover:from-green-600 hover:to-emerald-700 transition shadow-lg">
                    Confirmer et r√©server
                </button>
            </div>

            <!-- FORMULAIRE DE CONTACT AVEC ONGLETS -->
            <div id="contactForm" class="hidden bg-white rounded-2xl shadow-xl p-6 md:p-8 mb-6">
                <h3 class="text-2xl font-bold text-gray-800 mb-2">Finaliser votre r√©servation</h3>
                <p class="text-gray-600 mb-6">Remplissez vos coordonn√©es pour confirmer votre course</p>

                <div id="recap" class="bg-blue-50 p-4 rounded-lg mb-6"></div>

                <!-- ONGLETS POUR ADRESSES PR√âCISES -->
                <div class="mb-6">
                    <div class="flex border-b-2 border-gray-200 mb-4" role="tablist">
                        <button
                            class="tab-button active flex-1 py-3 px-4 text-center font-semibold border-b-2 border-blue-600 text-blue-600 transition"
                            data-tab="address-tab"
                            role="tab"
                            aria-selected="true"
                        >
                            üìç Adresse de d√©part
                        </button>
                        <button
                            class="tab-button flex-1 py-3 px-4 text-center font-semibold border-b-2 border-transparent text-gray-600 hover:text-gray-800 transition"
                            data-tab="destination-tab"
                            role="tab"
                            aria-selected="false"
                        >
                            üéØ Adresse de destination
                        </button>
                    </div>

                    <!-- ONGLET 1: ADRESSE DE D√âPART -->
                    <div id="address-tab" class="tab-content active p-4 bg-blue-50 rounded-lg mb-6 border border-blue-200">
                        <h4 class="text-lg font-semibold text-gray-800 mb-3">Adresse pr√©cise de d√©part</h4>
                        <div class="autocomplete-wrapper">
                            <input
                                type="text"
                                id="preciseDepartureAddress"
                                placeholder="Exemple: 15 rue de la Paix, Saint-Denis"
                                class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition"
                                autocomplete="off"
                            >
                            <div id="departureSuggestions" class="autocomplete-list"></div>
                        </div>
                        <small class="text-gray-600 mt-2 block">üí° Commencez √† taper votre adresse pour voir les suggestions</small>
                        <div id="departureAddressConfirm" class="mt-4 p-3 bg-white rounded border-l-4 border-green-400 hidden">
                            <p class="text-sm text-gray-700"><strong>‚úÖ Adresse s√©lectionn√©e :</strong></p>
                            <p id="departureAddressText" class="text-gray-800 font-semibold mt-1"></p>
                        </div>
                    </div>

                    <!-- ONGLET 2: ADRESSE DE DESTINATION -->
                    <div id="destination-tab" class="tab-content hidden p-4 bg-green-50 rounded-lg mb-6 border border-green-200">
                        <h4 class="text-lg font-semibold text-gray-800 mb-3">Adresse pr√©cise de destination</h4>
                        <div class="autocomplete-wrapper">
                            <input
                                type="text"
                                id="preciseDestinationAddress"
                                placeholder="Exemple: 5 all√©e des Flamboyants, Saint-Gilles"
                                class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition"
                                autocomplete="off"
                            >
                            <div id="destinationSuggestions" class="autocomplete-list"></div>
                        </div>
                        <small class="text-gray-600 mt-2 block">üí° Commencez √† taper votre adresse pour voir les suggestions</small>
                        <div id="destinationAddressConfirm" class="mt-4 p-3 bg-white rounded border-l-4 border-green-400 hidden">
                            <p class="text-sm text-gray-700"><strong>‚úÖ Adresse s√©lectionn√©e :</strong></p>
                            <p id="destinationAddressText" class="text-gray-800 font-semibold mt-1"></p>
                        </div>
                    </div>
                </div>

                <form id="finalForm" class="space-y-4">
                    <div>
                        <label class="flex items-center text-sm font-semibold text-gray-700 mb-2">
                            <span class="mr-2">üë§</span>
                            Nom complet *
                        </label>
                        <input type="text" id="name" required class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition" placeholder="Votre nom et pr√©nom">
                    </div>

                    <div>
                        <label class="flex items-center text-sm font-semibold text-gray-700 mb-2">
                            <span class="mr-2">üìû</span>
                            T√©l√©phone *
                        </label>
                        <input type="tel" id="phone" required class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition" placeholder="+262 06 XX XX XX XX">
                    </div>

                    <div>
                        <label class="flex items-center text-sm font-semibold text-gray-700 mb-2">
                            <span class="mr-2">‚úâÔ∏è</span>
                            Email (optionnel)
                        </label>
                        <input type="email" id="email" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition" placeholder="votre@email.com">
                    </div>

                    <div>
                        <label class="flex items-center text-sm font-semibold text-gray-700 mb-2">
                            <span class="mr-2">üí¨</span>
                            Message ou informations compl√©mentaires
                        </label>
                        <textarea id="message" rows="4" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none transition resize-none" placeholder="Bagages, animaux, si√®ges enfants, etc."></textarea>
                    </div>

                    <div class="bg-gray-50 p-4 rounded-lg text-xs text-gray-600">
                        <p>En soumettant ce formulaire, vous acceptez d'√™tre contact√© par Captain VTC pour confirmer votre r√©servation.</p>
                    </div>

                    <div class="flex flex-col sm:flex-row gap-3">
                        <button type="button" onclick="hideContactForm()" class="flex-1 bg-gray-200 text-gray-700 py-3 rounded-lg font-semibold hover:bg-gray-300 transition">
                            Retour
                        </button>
                        <button type="submit" class="flex-1 bg-gradient-to-r from-green-500 to-emerald-600 text-white py-3 rounded-lg font-semibold hover:from-green-600 hover:to-emerald-700 transition shadow-lg">
                            Envoyer la demande
                        </button>
                    </div>
                </form>
            </div>

            <div class="bg-white rounded-xl shadow-md p-6 mt-6">
                <h4 class="font-bold text-gray-800 mb-4 text-lg">üìã Grille Tarifaire Captain VTC</h4>
                <div class="grid md:grid-cols-2 gap-4">
                    <div class="bg-purple-50 p-4 rounded-lg border-l-4 border-purple-500">
                        <h5 class="font-semibold text-purple-900 mb-3">üåô Suppl√©ments horaires</h5>
                        <p class="text-sm text-gray-700 mb-2">Nuit (23h-6h) Hors A√©roport : <span class="font-bold">+15‚Ç¨</span></p>
                        <p class="text-xs text-purple-700">Automatiquement calcul√© selon l'heure choisie</p>
                    </div>
                    <div class="bg-amber-50 p-4 rounded-lg border-l-4 border-amber-500">
                        <h5 class="font-semibold text-amber-900 mb-3">‚úàÔ∏è Transfert A√©roport</h5>
                        <p class="text-sm text-gray-700 mb-2">Majoration heures de pointe : <span class="font-bold">+30‚Ç¨</span></p>
                        <p class="text-xs text-amber-700">Heures de pointe : 6h-9h et 15h30-18h</p>
                    </div>
                </div>
                <div class="mt-4 bg-blue-50 p-4 rounded-lg border-l-4 border-blue-600">
                    <p class="text-sm text-gray-700"><strong>üìå Note :</strong> Tarifs forfaitaires selon grille Captain VTC. Les suppl√©ments sont calcul√©s automatiquement. Dimanche et jours f√©ri√©s : nous consulter.</p>
                </div>
            </div>

            <div class="bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl shadow-lg p-6 mt-6 text-white">
                <h4 class="font-bold text-xl mb-4">üíº Pourquoi choisir Captain VTC ?</h4>
                <div class="grid md:grid-cols-3 gap-4">
                    <div class="bg-white bg-opacity-20 p-4 rounded-lg backdrop-blur">
                        <div class="text-3xl mb-2">üöó</div>
                        <h5 class="font-semibold mb-2">V√©hicules Monospace 7 Places Climatis√©</h5>
                        <p class="text-sm text-blue-100">Confort et s√©curit√© garantis</p>
                    </div>
                    <div class="bg-white bg-opacity-20 p-4 rounded-lg backdrop-blur">
                        <div class="text-3xl mb-2">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                        <h5 class="font-semibold mb-2">Service premium</h5>
                        <p class="text-sm text-blue-100">Chauffeurs certifi√©s titulaires de la Carte Professionnelle VTC</p>
                    </div>
                    <div class="bg-white bg-opacity-20 p-4 rounded-lg backdrop-blur">
                        <div class="text-3xl mb-2">üì±</div>
                        <h5 class="font-semibold mb-2">Disponible 24/7</h5>
                        <p class="text-sm text-blue-100">R√©servation Facile et Rapide</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-gray-800 text-white py-8 mt-12">
        <div class="container mx-auto px-4">
            <div class="text-center space-y-4">
                <div>
                    <h3 class="text-xl font-bold mb-2">Captain VTC</h3>
                    <p class="text-sm text-gray-400">Transport de personnes √† La R√©union</p>
                </div>
                <div class="flex flex-col md:flex-row justify-center items-center gap-4 text-sm">
                    <a href="tel:+262693479647" class="hover:text-blue-400 transition">
                        üìû +262 06 93 47 96 47
                    </a>
                    <span class="hidden md:inline text-gray-600">|</span>
                    <a href="mailto:contact@captainvtc.com" class="hover:text-blue-400 transition">
                        ‚úâÔ∏è contact@captainvtc.com
                    </a>
                </div>
                <div class="pt-4 border-t border-gray-700">
                    <p class="text-xs text-gray-400">¬© 2025 Captain VTC - Tous droits r√©serv√©s</p>
                    <p class="text-xs text-gray-500 mt-1">Service disponible 24h/24 - 7j/7</p>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // ============================================================
        // DONN√âES ORIGINALES - INCHANG√âES
        // ============================================================
        const ADDRESSES = ["Saint-Denis","‚úàÔ∏è A√©roport Roland Garros","Saint-Gilles-les-Bains","Saint-Pierre","Saint-Beno√Æt","Saint-Andr√©","Hell-Bourg","Salazie","Sainte-Rose","Saint-Philippe","Saint-Joseph","Le Tampon","G√Æte du Volcan","Plaine des Palmistes","‚úàÔ∏è Pierrefonds a√©roport","Saint-Louis","Cilaos","L'√âtang-Sal√©","Les Avirons","Le Ma√Ødo","Plaine des Cafres","Etang sal√© les Hauts","Tampon 17em KM","Saint-Paul","Le Port","La Possession","Petite-√éle"];

        const TARIFS = {"Saint-Andr√©_Saint-Gilles-les-Bains":105,"Saint-Andr√©_Saint-Denis":55,"Saint-Andr√©_A√©roport Roland Garros":55,"Saint-Andr√©_Saint-Pierre":165,"Saint-Andr√©_Saint-Beno√Æt":50,"Hell-Bourg_Saint-Gilles-les-Bains":210,"Hell-Bourg_Saint-Denis":175,"Hell-Bourg_A√©roport Roland Garros":175,"Hell-Bourg_Saint-Pierre":210,"Hell-Bourg_Saint-Beno√Æt":115,"Salazie_Saint-Gilles-les-Bains":195,"Salazie_Saint-Denis":165,"Salazie_A√©roport Roland Garros":165,"Salazie_Saint-Pierre":195,"Salazie_Saint-Beno√Æt":105,"Saint-Beno√Æt_Saint-Gilles-les-Bains":115,"Saint-Beno√Æt_Saint-Denis":70,"Saint-Beno√Æt_A√©roport Roland Garros":70,"Saint-Beno√Æt_Saint-Pierre":175,"Saint-Beno√Æt_Saint-Beno√Æt":40,"Sainte-Rose_Saint-Gilles-les-Bains":175,"Sainte-Rose_Saint-Denis":140,"Sainte-Rose_A√©roport Roland Garros":140,"Sainte-Rose_Saint-Pierre":175,"Sainte-Rose_Saint-Beno√Æt":80,"Saint-Philippe_Saint-Gilles-les-Bains":175,"Saint-Philippe_Saint-Denis":220,"Saint-Philippe_A√©roport Roland Garros":220,"Saint-Philippe_Saint-Pierre":105,"Saint-Philippe_Saint-Beno√Æt":105,"Saint-Joseph_Saint-Gilles-les-Bains":125,"Saint-Joseph_Saint-Denis":170,"Saint-Joseph_A√©roport Roland Garros":170,"Saint-Joseph_Saint-Pierre":50,"Saint-Joseph_Saint-Beno√Æt":170,"Saint-Pierre_Saint-Gilles-les-Bains":85,"Saint-Pierre_Saint-Denis":130,"Saint-Pierre_A√©roport Roland Garros":130,"Saint-Pierre_Saint-Pierre":25,"Saint-Pierre_Saint-Beno√Æt":200,"Le Tampon_Saint-Gilles-les-Bains":105,"Le Tampon_Saint-Denis":150,"Le Tampon_A√©roport Roland Garros":150,"Le Tampon_Saint-Pierre":30,"Le Tampon_Saint-Beno√Æt":200,"G√Æte du Volcan_Saint-Gilles-les-Bains":210,"G√Æte du Volcan_Saint-Denis":210,"G√Æte du Volcan_A√©roport Roland Garros":210,"G√Æte du Volcan_Saint-Pierre":175,"G√Æte du Volcan_Saint-Beno√Æt":175,"Saint-Denis_Saint-Gilles-les-Bains":89,"Saint-Denis_Saint-Denis":35,"Saint-Denis_A√©roport Roland Garros":35,"Saint-Denis_Saint-Pierre":130,"Saint-Denis_Saint-Beno√Æt":70,"Plaine des Palmistes_Saint-Gilles-les-Bains":210,"Plaine des Palmistes_Saint-Denis":140,"Plaine des Palmistes_A√©roport Roland Garros":140,"Plaine des Palmistes_Saint-Pierre":115,"Plaine des Palmistes_Saint-Beno√Æt":80,"Pierrefonds a√©roport_Saint-Gilles-les-Bains":80,"Pierrefonds a√©roport_Saint-Denis":115,"Pierrefonds a√©roport_A√©roport Roland Garros":115,"Pierrefonds a√©roport_Saint-Pierre":25,"Pierrefonds a√©roport_Saint-Beno√Æt":200,"Saint-Louis_Saint-Gilles-les-Bains":75,"Saint-Louis_Saint-Denis":120,"Saint-Louis_A√©roport Roland Garros":120,"Saint-Louis_Saint-Pierre":35,"Saint-Louis_Saint-Beno√Æt":200,"Cilaos_Saint-Gilles-les-Bains":230,"Cilaos_Saint-Denis":250,"Cilaos_A√©roport Roland Garros":250,"Cilaos_Saint-Pierre":160,"Cilaos_Saint-Beno√Æt":300,"L'√âtang-Sal√©_Saint-Gilles-les-Bains":70,"L'√âtang-Sal√©_Saint-Denis":120,"L'√âtang-Sal√©_A√©roport Roland Garros":120,"L'√âtang-Sal√©_Saint-Pierre":45,"L'√âtang-Sal√©_Saint-Beno√Æt":200,"Les Avirons_Saint-Gilles-les-Bains":70,"Les Avirons_Saint-Denis":120,"Les Avirons_A√©roport Roland Garros":120,"Les Avirons_Saint-Pierre":55,"Les Avirons_Saint-Beno√Æt":140,"Saint-Gilles-les-Bains_Saint-Gilles-les-Bains":35,"Saint-Gilles-les-Bains_Saint-Denis":89,"Saint-Gilles-les-Bains_A√©roport Roland Garros":89,"Saint-Gilles-les-Bains_Saint-Pierre":85,"Saint-Gilles-les-Bains_Saint-Beno√Æt":115,"Le Ma√Ødo_Saint-Gilles-les-Bains":95,"Le Ma√Ødo_Saint-Denis":140,"Le Ma√Ødo_A√©roport Roland Garros":140,"Le Ma√Ødo_Saint-Pierre":140,"Le Ma√Ødo_Saint-Beno√Æt":175,"Plaine des Cafres_Saint-Gilles-les-Bains":150,"Plaine des Cafres_Saint-Denis":200,"Plaine des Cafres_A√©roport Roland Garros":200,"Plaine des Cafres_Saint-Pierre":90,"Plaine des Cafres_Saint-Beno√Æt":180,"Etang sal√© les Hauts_Saint-Gilles-les-Bains":90,"Etang sal√© les Hauts_Saint-Denis":120,"Etang sal√© les Hauts_A√©roport Roland Garros":120,"Etang sal√© les Hauts_Saint-Pierre":50,"Etang sal√© les Hauts_Saint-Beno√Æt":200,"Tampon 17em KM_Saint-Gilles-les-Bains":120,"Tampon 17em KM_Saint-Denis":180,"Tampon 17em KM_A√©roport Roland Garros":180,"Tampon 17em KM_Saint-Pierre":60,"Tampon 17em KM_Saint-Beno√Æt":200,"Saint-Paul_Saint-Gilles-les-Bains":45,"Saint-Paul_Saint-Denis":75,"Saint-Paul_A√©roport Roland Garros":75,"Saint-Paul_Saint-Pierre":95,"Saint-Paul_Saint-Beno√Æt":105,"Le Port_Saint-Gilles-les-Bains":55,"Le Port_Saint-Denis":60,"Le Port_A√©roport Roland Garros":60,"Le Port_Saint-Pierre":105,"Le Port_Saint-Beno√Æt":105,"La Possession_Saint-Gilles-les-Bains":60,"La Possession_Saint-Denis":60,"La Possession_A√©roport Roland Garros":60,"La Possession_Saint-Pierre":110,"La Possession_Saint-Beno√Æt":115,"Petite-√éle_Saint-Gilles-les-Bains":110,"Petite-√éle_Saint-Denis":160,"Petite-√éle_A√©roport Roland Garros":160,"Petite-√éle_Saint-Pierre":45,"Petite-√éle_Saint-Beno√Æt":180};

        let routeData = null;
        let currentDeparturePlace = null;
        let currentDestinationPlace = null;

        // ============================================================
        // GESTIONNAIRE AUTOCOMPLETE PERSONNALIS√â
        // ============================================================
        class CustomAutocomplete {
            constructor(inputId, suggestionsId, confirmId, addressTextId) {
                this.input = document.getElementById(inputId);
                this.suggestionsList = document.getElementById(suggestionsId);
                this.confirmDiv = document.getElementById(confirmId);
                this.addressText = document.getElementById(addressTextId);
                this.selectedPlace = null;
                this.initListeners();
            }

            initListeners() {
                this.input.addEventListener('input', (e) => this.handleInput(e));
                this.input.addEventListener('blur', () => {
                    setTimeout(() => {
                        if (this.suggestionsList) {
                            this.suggestionsList.classList.remove('active');
                        }
                    }, 200);
                });
            }

            handleInput(e) {
                const query = e.target.value.trim();
                if (query.length < 2) {
                    this.suggestionsList.classList.remove('active');
                    return;
                }

                if (window.google && window.google.maps && window.google.maps.places) {
                    const service = new google.maps.places.PlacesService(
                        document.createElement('div')
                    );

                    const request = {
                        query: query + ', R√©union, France',
                        componentRestrictions: { country: 'RE' }
                    };

                    service.textSearch(request, (results, status) => {
                        if (status === google.maps.places.PlacesServiceStatus.OK && results) {
                            this.showSuggestions(results.slice(0, 5));
                        }
                    });
                }
            }

            showSuggestions(results) {
                this.suggestionsList.innerHTML = '';
                results.forEach((place) => {
                    const item = document.createElement('div');
                    item.className = 'autocomplete-item';
                    item.innerHTML = `
                        <div class="font-semibold text-sm">${place.name}</div>
                        <div class="text-xs text-gray-500">${place.formatted_address || ''}</div>
                    `;
                    item.addEventListener('click', () => this.selectPlace(place));
                    this.suggestionsList.appendChild(item);
                });
                this.suggestionsList.classList.add('active');
            }

            selectPlace(place) {
                this.selectedPlace = place;
                this.input.value = place.formatted_address || place.name;
                this.addressText.textContent = place.formatted_address || place.name;
                this.confirmDiv.classList.remove('hidden');
                this.suggestionsList.classList.remove('active');
                console.log('‚úÖ Adresse s√©lectionn√©e:', place.formatted_address);
            }
        }

        function cleanLocationName(name) {
            return name.replace('‚úàÔ∏è ', '');
        }

        // ============================================================
        // SYST√àME D'ONGLETS
        // ============================================================
        function initTabs() {
            const tabButtons = document.querySelectorAll('.tab-button');
            
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    tabButtons.forEach(btn => {
                        btn.classList.remove('active', 'border-blue-600', 'text-blue-600');
                        btn.classList.add('border-transparent', 'text-gray-600');
                    });
                    
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                        content.classList.add('hidden');
                    });
                    
                    button.classList.add('active', 'border-blue-600', 'text-blue-600');
                    button.classList.remove('border-transparent', 'text-gray-600');
                    
                    const tabId = button.getAttribute('data-tab');
                    document.getElementById(tabId).classList.remove('hidden');
                    document.getElementById(tabId).classList.add('active');
                });
            });
        }

        // ============================================================
        // INITIALISATION
        // ============================================================
        window.addEventListener('load', function() {
            console.log('üî• Application charg√©e !');
            
            const dep = document.getElementById('departure');
            const dest = document.getElementById('destination');
            
            ADDRESSES.forEach(addr => {
                dep.innerHTML += `<option value="${addr}">${addr}</option>`;
                dest.innerHTML += `<option value="${addr}">${dest}</option>`;
            });
            
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('date').min = today;

            function checkAirport() {
                const depValue = dep.value;
                const destValue = dest.value;
                const airportFields = document.getElementById('airportFields');
                
                if (depValue.toLowerCase().includes('a√©roport') || destValue.toLowerCase().includes('a√©roport')) {
                    airportFields.classList.remove('hidden');
                } else {
                    airportFields.classList.add('hidden');
                }
            }

            dep.addEventListener('change', checkAirport);
            dest.addEventListener('change', checkAirport);
            
            console.log('‚úÖ Initialisation termin√©e');
            
            // Initialiser les onglets
            initTabs();
            console.log('‚úÖ Onglets initialis√©s');
            
            // Initialiser les autocompletes personnalis√©s
            new CustomAutocomplete('preciseDepartureAddress', 'departureSuggestions', 'departureAddressConfirm', 'departureAddressText');
            new CustomAutocomplete('preciseDestinationAddress', 'destinationSuggestions', 'destinationAddressConfirm', 'destinationAddressText');
            console.log('‚úÖ Autocompletes initialis√©s');
            
            // √âv√©nement submit du formulaire final
            const finalForm = document.getElementById('finalForm');
            finalForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                handleFormSubmit();
            });
        });

        function toggleInfo() {
            const content = document.getElementById('infoContent');
            const arrow = document.getElementById('infoArrow');
            if (content.classList.contains('hidden')) {
                content.classList.remove('hidden');
                arrow.textContent = '‚ñ≤';
            } else {
                content.classList.add('hidden');
                arrow.textContent = '‚ñº';
            }
        }

        function showError(msg, type = 'error') {
            const errorDiv = document.getElementById('errorMessage');
            const errorText = document.getElementById('errorText');
            errorText.textContent = msg;
            errorDiv.classList.remove('hidden');
            if (type === 'info') {
                errorDiv.className = 'bg-blue-50 border-l-4 border-blue-500 p-4 rounded flex items-start space-x-3';
            }
            setTimeout(() => {
                errorDiv.classList.add('hidden');
            }, 5000);
        }

        // ============================================================
        // CALCUL DU TARIF - CODE ORIGINAL INCHANG√â
        // ============================================================
        function calculatePrice() {
            const dep = document.getElementById('departure').value;
            const dest = document.getElementById('destination').value;
            const date = document.getElementById('date').value;
            const time = document.getElementById('time').value;
            const pass = document.getElementById('passengers').value;

            if (!dep || !dest) {
                showError('Veuillez renseigner les adresses de d√©part et destination');
                return;
            }

            if (!date || !time) {
                showError('Veuillez renseigner la date et l\'heure de d√©part');
                return;
            }

            const selectedDateTime = new Date(`${date}T${time}`);
            if (selectedDateTime < new Date()) {
                showError('La date et l\'heure doivent √™tre dans le futur');
                return;
            }

            const cleanDep = cleanLocationName(dep);
            const cleanDest = cleanLocationName(dest);

            let basePrice;

            if (dep === dest) {
                basePrice = cleanDep === 'Saint-Pierre' ? 25 : 35;
            } else {
                const key1 = `${cleanDep}_${cleanDest}`;
                const key2 = `${cleanDest}_${cleanDep}`;
                basePrice = TARIFS[key1] || TARIFS[key2];
            }

            if (!basePrice) {
                showError('Trajet non disponible. Contactez-nous au +262 06 93 47 96 47 pour un devis personnalis√©.');
                return;
            }

            let totalPrice = basePrice;
            let supplements = [];
            
            const isAirport = dep.toLowerCase().includes('a√©roport') || dest.toLowerCase().includes('a√©roport');
            
            let flightNumber = '';
            let luggage = '';
            if (isAirport) {
                flightNumber = document.getElementById('flightNumber').value || 'Non renseign√©';
                luggage = document.getElementById('luggage').value || '0';
            }
            
            const hour = parseInt(time.split(':')[0]);
            const minute = parseInt(time.split(':')[1]);
            const timeInMinutes = hour * 60 + minute;
            
            const isNight = hour >= 23 || hour < 6;
            const isPeakMorning = timeInMinutes >= 360 && timeInMinutes < 540;
            const isPeakEvening = timeInMinutes >= 930 && timeInMinutes < 1080;
            const isPeak = isPeakMorning || isPeakEvening;
            
            const isSunday = new Date(date).getDay() === 0;

            if (isNight && !isAirport) {
                totalPrice += 15;
                supplements.push({label: 'Nuit (23h-6h) Hors A√©roport', amount: 15});
            }
            
            if (isAirport && isPeak) {
                totalPrice += 30;
                supplements.push({label: 'Heures de pointe a√©roport (6h-9h / 15h30-18h)', amount: 30});
            }

            routeData = {
                departure: dep,
                destination: dest,
                date: date,
                time: time,
                passengers: pass,
                basePrice: basePrice,
                totalPrice: totalPrice,
                supplements: supplements,
                isAirport: isAirport,
                isSunday: isSunday,
                flightNumber: flightNumber,
                luggage: luggage,
                preciseDepartureAddress: document.getElementById('preciseDepartureAddress').value || dep,
                preciseDestinationAddress: document.getElementById('preciseDestinationAddress').value || dest
            };

            document.getElementById('totalPrice').textContent = totalPrice.toFixed(2) + ' ‚Ç¨';
            if (supplements.length > 0) {
                document.getElementById('priceDetail').textContent = `(Base: ${basePrice}‚Ç¨ + suppl√©ments)`;
            } else {
                document.getElementById('priceDetail').textContent = '';
            }

            document.getElementById('routeDisplay').textContent = `${dep} ‚Üí ${dest}`;
            document.getElementById('dateTimeDisplay').textContent = new Date(date).toLocaleDateString('fr-FR') + ' √† ' + time;
            document.getElementById('passengersDisplay').textContent = pass + ' personne' + (pass > 1 ? 's' : '');

            if (isAirport) {
                document.getElementById('airportBadge').classList.remove('hidden');
            } else {
                document.getElementById('airportBadge').classList.add('hidden');
            }

            if (supplements.length > 0) {
                let suppHtml = '';
                supplements.forEach(supp => {
                    suppHtml += `<div class="flex justify-between items-center text-sm"><span class="text-amber-700">‚Ä¢ ${supp.label}</span><span class="font-semibold text-amber-900">+${supp.amount}‚Ç¨</span></div>`;
                });
                if (isSunday) {
                    suppHtml += '<p class="text-xs text-amber-600 mt-3 italic">* Le suppl√©ment dimanche sera confirm√© lors de votre r√©servation</p>';
                }
                document.getElementById('supplementsList').innerHTML = suppHtml;
                document.getElementById('supplementsSection').classList.remove('hidden');
            } else {
                document.getElementById('supplementsSection').classList.add('hidden');
            }

            document.getElementById('resultSection').classList.remove('hidden');
            document.getElementById('resultSection').scrollIntoView({behavior: 'smooth'});
        }

        function showContactForm() {
            const recap = `
                <p class="text-sm font-semibold text-blue-900 mb-2">R√©capitulatif :</p>
                <p class="text-sm text-blue-800">${routeData.departure} ‚Üí ${routeData.destination}</p>
                <p class="text-sm text-blue-800">Le ${new Date(routeData.date).toLocaleDateString('fr-FR')} √† ${routeData.time}</p>
                <p class="text-2xl font-bold text-blue-900 mt-2">${routeData.totalPrice.toFixed(2)} ‚Ç¨</p>
            `;
            document.getElementById('recap').innerHTML = recap;
            document.getElementById('contactForm').classList.remove('hidden');
            document.getElementById('contactForm').scrollIntoView({behavior: 'smooth'});
        }

        function hideContactForm() {
            document.getElementById('contactForm').classList.add('hidden');
            document.getElementById('resultSection').scrollIntoView({behavior: 'smooth'});
        }

        // ============================================================
        // GESTION DE LA SOUMISSION DU FORMULAIRE
        // ============================================================
        async function handleFormSubmit() {
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const email = document.getElementById('email').value;
            const message = document.getElementById('message').value;
            const preciseDeparture = document.getElementById('preciseDepartureAddress').value;
            const preciseDestination = document.getElementById('preciseDestinationAddress').value;

            if (!name || !phone) {
                showError('Veuillez renseigner au minimum votre nom et t√©l√©phone');
                return;
            }

            try {
                showError('‚è≥ Traitement de votre demande...', 'info');

                const emailMessage = `
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üöñ NOUVELLE R√âSERVATION CAPTAIN VTC
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

üë§ CLIENT
Nom : ${name}
T√©l√©phone : ${phone}
Email : ${email || 'Non renseign√©'}

üìç ITIN√âRAIRE
Point de d√©part : ${routeData.departure}
Adresse pr√©cise (d√©part) : ${preciseDeparture}

Destination : ${routeData.destination}
Adresse pr√©cise (destination) : ${preciseDestination}

üìÖ DATE & HEURE
Date : ${new Date(routeData.date).toLocaleDateString('fr-FR')}
Heure : ${routeData.time}

üë• PASSAGERS
${routeData.passengers} personne(s)

${routeData.isAirport ? `‚úàÔ∏è INFORMATIONS DE VOL\r\nNum√©ro de vol : ${routeData.flightNumber}\r\nNombre de bagages : ${routeData.luggage}\r\n\r\n` : ''}üí∞ TARIFICATION
Tarif de base : ${routeData.basePrice}‚Ç¨
${routeData.supplements.length > 0 ? routeData.supplements.map(s => `${s.label} : +${s.amount}‚Ç¨`).join('\n') : 'Aucun suppl√©ment'}
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
TOTAL : ${routeData.totalPrice.toFixed(2)}‚Ç¨

üìù INFORMATIONS SUPPL√âMENTAIRES
${message || 'Aucune information'}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
                `;

                const formData = new FormData();
                formData.append('access_key', 'a6545d07-198a-4895-8aff-d59f1aa0a92e');
                formData.append('subject', 'üöñ Nouvelle r√©servation Captain VTC');
                formData.append('from_name', 'Captain VTC - R√©servation');
                formData.append('name', name);
                formData.append('email', email || 'noreply@captainvtc.com');
                formData.append('phone', phone);
                formData.append('message', emailMessage);

                const response = await fetch("https://api.web3forms.com/submit", {
                    method: "POST",
                    body: formData
                });

                const result = await response.json();

                if (result.success) {
                    document.getElementById('contactForm').classList.add('hidden');
                    document.getElementById('resultSection').classList.add('hidden');
                    document.getElementById('bookingForm').classList.add('hidden');
                    
                    const successMsg = document.getElementById('successMessage');
                    successMsg.className = 'bg-green-50 border-2 border-green-500 rounded-xl p-6 mb-6';
                    successMsg.innerHTML = `
                        <div class="space-y-4">
                            <div class="flex items-center space-x-3">
                                <span class="text-4xl">‚úÖ</span>
                                <div>
                                    <h3 class="text-2xl font-bold text-green-900">R√©servation confirm√©e !</h3>
                                    <p class="text-green-700 text-lg mt-1">Demande bien re√ßue</p>
                                </div>
                            </div>
                            <div class="bg-white p-4 rounded-lg border-2 border-green-300 space-y-2">
                                <p class="text-green-700 flex items-center">
                                    <span class="mr-2">‚úÖ</span>
                                    <span>Email de confirmation envoy√© √† Captain VTC</span>
                                </p>
                                <p class="text-green-700 flex items-center">
                                    <span class="mr-2">‚úÖ</span>
                                    <span>Adresses pr√©cises enregistr√©es</span>
                                </p>
                            </div>
                            <div class="bg-green-100 p-3 rounded-lg border border-green-400">
                                <p class="text-green-800 text-center font-semibold">
                                    üìû Nous vous contacterons rapidement au ${phone}
                                </p>
                            </div>
                        </div>
                    `;
                    successMsg.classList.remove('hidden');
                    
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                    
                    setTimeout(() => {
                        location.reload();
                    }, 5000);
                } else {
                    throw new Error('Erreur d\'envoi');
                }
            } catch (error) {
                console.error('Erreur:', error);
                showError('Erreur lors de l\'envoi. Veuillez nous contacter par t√©l√©phone au +262 06 93 47 96 47');
            }
        }
    </script>
</body>
</html>
Commit message:
"Ajouter application calculateur VTC"

Extended description (optionnel):
Vide
